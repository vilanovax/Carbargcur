# ุฑุงูููุง ูุฏุฑุช ุชูุธูุงุช ูุงุดูโุญุณุงุจโูุง

## ๐ ููุฏูู

ุณุณุชู ุชูุธูุงุช ูุงุดูโุญุณุงุจโูุง ุจู ุงุฏููโูุง ุงุฌุงุฒู ูโุฏูุฏ ุชุง ุจุฏูู ูุงุฒ ุจู ุชุบุฑ ฺฉุฏ ู deploy ูุฌุฏุฏุ ูุฑูููโูุงุ ูุฑุฎโูุง ู ูพุงุฑุงูุชุฑูุง ูุญุงุณุจุงุช ูุงุดูโุญุณุงุจโูุง ุญูููุ ูุงูุงุช ู ูุงู ุฑุง ุจูโุฑูุฒุฑุณุงู ฺฉููุฏ.

## ๐ฏ ูุฒุงุง

- **ุจุฏูู ูุงุฒ ุจู ฺฉุฏ**: ุชุบุฑุงุช ุงุฒ ุทุฑู ูพูู ุงุฏูู ุงูุฌุงู ูโุดูุฏ
- **ุงูุนุทุงูโูพุฐุฑ**: ูพุดุชุจุงู ุงุฒ ฺูุฏู ุณุงู ู ูุณุฎู ูุฎุชูู
- **ุชุงุฑุฎฺู**: ุฐุฎุฑู ุชูุงู ุชุบุฑุงุช ุจุง ุงุทูุงุนุงุช ุงุฌุงุฏฺฉููุฏู/ูุฑุงุดโฺฉููุฏู
- **Fallback**: ุฏุฑ ุตูุฑุช ูุจูุฏ config ูุนุงูุ ุงุฒ ููุงุฏุฑ ูพุดโูุฑุถ ุงุณุชูุงุฏู ูโุดูุฏ
- **Preview**: ูพุดโููุงุด ูุญุงุณุจุงุช ูุจู ุงุฒ ุฐุฎุฑู

## ๐ ุฏุณุชุฑุณ ุจู ูพูู ูุฏุฑุช

1. ูุงุฑุฏ ูพูู ุงุฏูู ุดูุฏ: `/admin`
2. ุงุฒ ููู ุณูุช ุฑุงุณุชุ ฺฏุฒูู **"ุชูุธูุงุช ูุงุดูโุญุณุงุจโูุง"** ุฑุง ุงูุชุฎุงุจ ฺฉูุฏ
3. ุง ูุณุชููุงู ุจู `/admin/calculator-configs` ุจุฑูุฏ

## ๐๏ธ ุณุงุฎุชุงุฑ ุชูุธูุงุช

### ูุงุดูโุญุณุงุจ ุญููู ู ุฏุณุชูุฒุฏ (Salary)

```json
{
  "version": "1.0",
  "year": 1403,
  "insurance": {
    "employee_rate": 7,
    "description": "ูุฑุฎ ุจูู ุณูู ฺฉุงุฑููุฏ"
  },
  "child_allowance": {
    "amount_per_child": 110000,
    "max_children": 3,
    "description": "ุญู ุงููุงุฏ ุจู ุงุฒุง ูุฑ ูุฑุฒูุฏ"
  },
  "overtime": {
    "base_hours": 220,
    "rate_multiplier": 1.4,
    "description": "ูุญุงุณุจู ุงุถุงููโฺฉุงุฑ"
  },
  "tax_brackets": [
    { "min": 0, "max": 10000000, "rate": 0, "label": "ุชุง ฑฐ ูููู - ูุนุงู" },
    { "min": 10000000, "max": 20000000, "rate": 0.10, "label": "ฑฐ ุชุง ฒฐ ูููู - ฑฐูช" },
    { "min": 20000000, "max": 40000000, "rate": 0.15, "label": "ฒฐ ุชุง ดฐ ูููู - ฑตูช" },
    { "min": 40000000, "max": null, "rate": 0.20, "label": "ุจุงูุง ดฐ ูููู - ฒฐูช" }
  ]
}
```

**ูพุงุฑุงูุชุฑูุง:**
- `insurance.employee_rate`: ูุฑุฎ ุจูู ุณูู ฺฉุงุฑููุฏ (ุฏุฑุตุฏ)
- `child_allowance.amount_per_child`: ูุจูุบ ุญู ุงููุงุฏ ุจู ุงุฒุง ูุฑ ูุฑุฒูุฏ (ุชููุงู)
- `child_allowance.max_children`: ุญุฏุงฺฉุซุฑ ุชุนุฏุงุฏ ูุฑุฒูุฏุงู ูุดููู
- `overtime.base_hours`: ุณุงุนุงุช ูพุงู ฺฉุงุฑ ูุงูุงูู
- `overtime.rate_multiplier`: ุถุฑุจ ูุญุงุณุจู ุงุถุงููโฺฉุงุฑ (ูุซูุงู 1.4 ุนู 140%)
- `tax_brackets`: ุขุฑุงูโุง ุงุฒ ูพููโูุง ูุงูุงุช ุจุง ูุญุฏูุฏู ู ูุฑุฎ

### ูุงุดูโุญุณุงุจ ูุงูุงุช (Tax)

```json
{
  "version": "1.0",
  "year": 1403,
  "tax_brackets": [
    { "from": 0, "to": 10000000, "rate": 0, "label": "ุชุง ฑฐ ูููู ุชููุงู - ูุนุงู" },
    { "from": 10000000, "to": 20000000, "rate": 0.10, "label": "ฑฐ ุชุง ฒฐ ูููู - ฑฐูช" },
    { "from": 20000000, "to": 40000000, "rate": 0.15, "label": "ฒฐ ุชุง ดฐ ูููู - ฑตูช" },
    { "from": 40000000, "to": null, "rate": 0.20, "label": "ุจุงูุง ดฐ ูููู - ฒฐูช" }
  ]
}
```

**ูพุงุฑุงูุชุฑูุง:**
- `tax_brackets[].from`: ุดุฑูุน ูุญุฏูุฏู (ุชููุงู)
- `tax_brackets[].to`: ูพุงุงู ูุญุฏูุฏู (null = ุจุฏูู ูุญุฏูุฏุช)
- `tax_brackets[].rate`: ูุฑุฎ ูุงูุงุช (ุนุฏุฏ ุงุนุดุงุฑ ุจู 0 ุชุง 1ุ ูุซูุงู 0.10 = 10%)
- `tax_brackets[].label`: ุจุฑฺุณุจ ููุงุด

### ูุงุดูโุญุณุงุจ ูุงู (Loan)

```json
{
  "version": "1.0",
  "year": 1403,
  "calculation_method": "amortization",
  "default_interest_rate": 18,
  "interest_rate_range": {
    "min": 0,
    "max": 30
  },
  "max_term_months": 360,
  "description": "ูุญุงุณุจู ุจุฑ ุงุณุงุณ ูุฑููู Amortization"
}
```

**ูพุงุฑุงูุชุฑูุง:**
- `calculation_method`: ุฑูุด ูุญุงุณุจู (ูุซูุงู "amortization" ุง "simple_interest")
- `default_interest_rate`: ูุฑุฎ ุจูุฑู ูพุดโูุฑุถ (ุฏุฑุตุฏ ุณุงูุงูู)
- `interest_rate_range.min`: ุญุฏุงูู ูุฑุฎ ุจูุฑู ูุฌุงุฒ
- `interest_rate_range.max`: ุญุฏุงฺฉุซุฑ ูุฑุฎ ุจูุฑู ูุฌุงุฒ
- `max_term_months`: ุญุฏุงฺฉุซุฑ ูุฏุช ุจุงุฒูพุฑุฏุงุฎุช (ูุงู)

## ๐ง ูุญูู ุงุณุชูุงุฏู

### ุงุฌุงุฏ ุชูุธูุงุช ุฌุฏุฏ

1. ุฏุฑ ุตูุญู ูุณุช calculator configsุ ุฑู ฺฉุงุฑุช ูุฑุจูุท ุจู calculator ููุฑุฏ ูุธุฑ ฺฉูฺฉ ฺฉูุฏ
2. ูุฑู ูุฑุงุด ุจุงุฒ ูโุดูุฏ
3. ุงุทูุงุนุงุช ุฑุง ูุงุฑุฏ ฺฉูุฏ:
   - **ุณุงู**: ุณุงู ุดูุณ (ูุซูุงู 1403)
   - **ูุณุฎู**: ุดูุงุฑู ูุณุฎู (ูุซูุงู "1.0")
   - **ูุถุนุช ูุนุงู**: ุขุง ุงู config ูุนุงู ุจุงุดุฏุ
   - **ุงุฏุฏุงุดุชโูุง**: ุชูุถุญุงุช ุงุถุงู
4. ูพุงุฑุงูุชุฑูุง ูุฑุจูุท ุจู ูุฑ calculator ุฑุง ุชูุธู ฺฉูุฏ
5. ุฏุฑ ุจุฎุด ูพุดโููุงุดุ ูุญุงุณุจุงุช ุฑุง ุจุง ููุงุฏุฑ ุชุณุช ุจุฑุฑุณ ฺฉูุฏ
6. ุฑู **"ุฐุฎุฑู ุชูุธูุงุช"** ฺฉูฺฉ ฺฉูุฏ

### ูุฑุงุด ุชูุธูุงุช ููุฌูุฏ

1. ุฏุฑ ุตูุญู ูุณุชุ ุฑู **ุขฺฉู ูุฑุงุด** ฺฉูุงุฑ config ููุฑุฏ ูุธุฑ ฺฉูฺฉ ฺฉูุฏ
2. ุชุบุฑุงุช ุฑุง ุงุนูุงู ฺฉูุฏ
3. ูพุดโููุงุด ุฑุง ุจุฑุฑุณ ฺฉูุฏ
4. ุฐุฎุฑู ฺฉูุฏ

### ูุนุงู/ุบุฑูุนุงู ฺฉุฑุฏู ุชูุธูุงุช

- ุฏุฑ ุตูุญู ูุณุชุ ุฑู **ุขฺฉู ฺุดู** ฺฉูฺฉ ฺฉูุฏ
- ุง ุฏุฑ ุตูุญู ูุฑุงุดุ ุณูุฆฺ "ูุถุนุช ูุนุงู" ุฑุง ุชุบุฑ ุฏูุฏ

## โ๏ธ ูฺฉุงุช ููู

### ูุญุฏูุฏุชโูุง
- **ููุท ฺฉ config ูุนุงู**: ุฏุฑ ูุฑ ุฒูุงูุ ููุท ฺฉ config ูุนุงู ุจุฑุง ูุฑ calculator ู ูุฑ ุณุงู ูโุชูุงูุฏ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ
- **Unique constraint**: ุชุฑฺฉุจ (ููุน calculator + ุณุงู) ุจุงุฏ ฺฉุชุง ุจุงุดุฏ

### ุงูููุช ุงุณุชูุงุฏู
1. ุงฺฏุฑ config ูุนุงู ุจุฑุง ุณุงู ุฌุงุฑ ูุฌูุฏ ุฏุงุดุชู ุจุงุดุฏ โ ุงุณุชูุงุฏู ุงุฒ ุขู
2. ุงฺฏุฑ config ูุนุงู ูุฌูุฏ ูุฏุงุดุชู ุจุงุดุฏ โ ุงุณุชูุงุฏู ุงุฒ ููุงุฏุฑ ูพุดโูุฑุถ hardcoded
3. ุฏุฑ ุตูุฑุช ุฎุทุง ุฏุฑ database โ ุงุณุชูุงุฏู ุงุฒ ููุงุฏุฑ ูพุดโูุฑุถ

### Validation
ุณุณุชู ูุจู ุงุฒ ุฐุฎุฑูุ ููุงุฑุฏ ุฒุฑ ุฑุง ุจุฑุฑุณ ูโฺฉูุฏ:
- ุชูุงู ููุฏูุง ุงูุฒุงู ูพุฑ ุดุฏู ุจุงุดูุฏ
- ูุฑุฎโูุง ุฏุฑ ูุญุฏูุฏู ูุนุชุจุฑ ุจุงุดูุฏ (0 ุชุง 100 ุง 0 ุชุง 1)
- ูพููโูุง ูุงูุงุช ุจู ุฏุฑุณุช ุชุนุฑู ุดุฏู ุจุงุดูุฏ
- ุณุงุฎุชุงุฑ JSON ูุนุชุจุฑ ุจุงุดุฏ

## ๐ ูุซุงู: ุชุบุฑ ููุงูู ุณุงู ุฌุฏุฏ

ูุฑุถ ฺฉูุฏ ููุงูู ูุงูุงุช ุณุงู 1404 ุชุบุฑ ฺฉุฑุฏู ู ูพูู ุฌุฏุฏ ุงุถุงูู ุดุฏู:

1. ุจู `/admin/calculator-configs` ุจุฑูุฏ
2. ุฑู **Tax Calculator** ฺฉูฺฉ ฺฉูุฏ
3. ฺฉ config ุฌุฏุฏ ุจุง ุณุงู **1404** ุจุณุงุฒุฏ
4. ูพููโูุง ูุงูุงุช ุฌุฏุฏ ุฑุง ุงุถุงูู ฺฉูุฏ:
   ```
   ูพูู 1: 0 ุชุง 15,000,000 - ูุนุงู (0%)
   ูพูู 2: 15,000,000 ุชุง 30,000,000 - 10%
   ูพูู 3: 30,000,000 ุชุง 60,000,000 - 15%
   ูพูู 4: ุจุงูุง 60,000,000 - 25%
   ```
5. ูุถุนุช ุฑุง **ูุนุงู** ฺฉูุฏ
6. ุฐุฎุฑู ฺฉูุฏ

ุญุงูุง ูุงุดูโุญุณุงุจ ูุงูุงุช ุจูโุตูุฑุช ุฎูุฏฺฉุงุฑ ุงุฒ ููุงูู ุฌุฏุฏ ุงุณุชูุงุฏู ูโฺฉูุฏ!

## ๐๏ธ ุฑุงูโุงูุฏุงุฒ ุงููู (ุจุฑุง ุชูุณุนูโุฏููุฏฺฏุงู)

### Seed ฺฉุฑุฏู Database

ุจุฑุง ุงุฌุงุฏ config ูุง ูพุดโูุฑุถ ุฏุฑ database:

```bash
npx ts-node scripts/seed-calculator-configs.ts
```

ุงู ุงุณฺฉุฑูพุช config ูุง ุณุงู 1403 ุฑุง ุจุง ููุงุฏุฑ ูพุดโูุฑุถ ุฏุฑ database ุงุฌุงุฏ ูโฺฉูุฏ.

### API Endpoints

**GET /api/admin/calculator-configs**
- ุฏุฑุงูุช ูุณุช ุชูุงู configs
- ูุงุฒ ุจู authentication ู admin access

**POST /api/admin/calculator-configs**
- ุงุฌุงุฏ config ุฌุฏุฏ
- Body: `{ calculatorType, configYear, config, isActive, notes }`

**GET /api/admin/calculator-configs/[type]**
- ุฏุฑุงูุช configs ฺฉ calculator ุฎุงุต
- Query params: `year` (ุงุฎุชุงุฑ)

**PUT /api/admin/calculator-configs/[type]**
- ุจูโุฑูุฒุฑุณุงู config ููุฌูุฏ
- Body: `{ id, config, isActive, notes, ... }`

**DELETE /api/admin/calculator-configs/[type]**
- Soft delete (ุชูุธู isActive = false)
- Query params: `id`

## ๐งช ุชุณุช

### ุชุณุช ุฏุฑ ูุญุท Local

1. ฺฉ config ุฌุฏุฏ ุจุง ููุงุฏุฑ ูุชูุงูุช ุจุณุงุฒุฏ
2. ุจู ุตูุญู calculator ุนููู ุจุฑูุฏ (ูุซูุงู `/utilities/salary-calculator`)
3. ูุญุงุณุจูโุง ุงูุฌุงู ุฏูุฏ
4. ุจุฑุฑุณ ฺฉูุฏ ฺฉู ูุชุงุฌ ุจุฑ ุงุณุงุณ config ุฌุฏุฏ ุจุงุดุฏ

### ุชุณุช Fallback

1. ุชูุงู configs ุฑุง ุบุฑูุนุงู ฺฉูุฏ
2. ุจู calculator ุจุฑูุฏ
3. ุจุงุฏ ูุญุงุณุจุงุช ุจุง ููุงุฏุฑ ูพุดโูุฑุถ ุงูุฌุงู ุดูุฏ

## ๐ ุนุจโุงุจ

### ูุญุงุณุจุงุช ุงุดุชุจุงู ุงุณุช
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู config ูุนุงู ุตุญุญ ุจุงุดุฏ
- ุฏุฑ admin panelุ preview ุฑุง ฺฺฉ ฺฉูุฏ
- ูุทูุฆู ุดูุฏ ฺฉู ูุฑุฎโูุง ุจู ุฏุฑุณุช ูุงุฑุฏ ุดุฏูโุงูุฏ (0.10 ุจุฑุง 10%)

### Config ุฐุฎุฑู ููโุดูุฏ
- ุฎุทุง validation ุฑุง ุจุฑุฑุณ ฺฉูุฏ
- ูุทูุฆู ุดูุฏ ุชุฑฺฉุจ (type + year) ุชฺฉุฑุงุฑ ูุณุช
- ุจุฑุฑุณ ฺฉูุฏ ฺฉู ุชูุงู ููุฏูุง ุงูุฒุงู ูพุฑ ุดุฏู ุจุงุดูุฏ

### ูุญุงุณุจุงุช ุงุฒ config ุงุณุชูุงุฏู ููโฺฉูุฏ
- ูุทูุฆู ุดูุฏ config **ูุนุงู** (isActive = true) ุงุณุช
- ุณุงู config ุฑุง ุจุง ุณุงู ุฌุงุฑ ุชุทุจู ุฏูุฏ
- ูุงฺฏโูุง ุณุฑูุฑ ุฑุง ุจุฑุฑุณ ฺฉูุฏ

## ๐ ููุงุจุน ุจุดุชุฑ

- [Database Schema](./DATABASE_SCHEMA.md)
- [Plan Document](~/.claude/plans/kind-kindling-sutton.md)
- ฺฉุฏ ููุจุน: `/src/lib/calculator-config.ts`
- API Routes: `/src/app/api/admin/calculator-configs/`
- Admin Pages: `/src/app/admin/calculator-configs/`

## ๐ ูพุดุชุจุงู

ุฏุฑ ุตูุฑุช ุจุฑูุฒ ูุดฺฉู:
1. Console browser ุฑุง ุจุฑุง ุฎุทุงูุง frontend ุจุฑุฑุณ ฺฉูุฏ
2. ูุงฺฏโูุง ุณุฑูุฑ ุฑุง ุจุฑุง ุฎุทุงูุง backend ุจุฑุฑุณ ฺฉูุฏ
3. ุงุฒ developer tools Network tab ุจุฑุง ุจุฑุฑุณ API calls ุงุณุชูุงุฏู ฺฉูุฏ
4. ุจุง ุชู ุชูุณุนู ุชูุงุณ ุจฺฏุฑุฏ

---

**ูฺฉุชู ุงููุช:** ููุท ุงุฏููโูุง ุชุฃุฏ ุดุฏู ุจู ุงู ุจุฎุด ุฏุณุชุฑุณ ุฏุงุฑูุฏ. ุชุบุฑุงุช ุฏุฑ config ูุง ุชุฃุซุฑ ูุณุชูู ุจุฑ ูุญุงุณุจุงุช ฺฉุงุฑุจุฑุงู ุฏุงุฑุฏุ ูพุณ ุจุง ุฏูุช ุนูู ฺฉูุฏ.
